<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tori Schultz">

<title>TS_DisEco_Fall2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TS_DisEco_Fall2024_files/libs/clipboard/clipboard.min.js"></script>
<script src="TS_DisEco_Fall2024_files/libs/quarto-html/quarto.js"></script>
<script src="TS_DisEco_Fall2024_files/libs/quarto-html/popper.min.js"></script>
<script src="TS_DisEco_Fall2024_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TS_DisEco_Fall2024_files/libs/quarto-html/anchor.min.js"></script>
<link href="TS_DisEco_Fall2024_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TS_DisEco_Fall2024_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TS_DisEco_Fall2024_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TS_DisEco_Fall2024_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TS_DisEco_Fall2024_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TS_DisEco_Fall2024</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tori Schultz </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">08/27/2024</h3>
<p>Find area of a circle with radius 5 cm.</p>
<p>Formula: ¶ * r^2</p>
<p>where r is the radius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate the area of a circle</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>area_of_circle <span class="ot">&lt;-</span> <span class="cf">function</span>(radius) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> pi <span class="sc">*</span> radius<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(area)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>radius <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># from the example</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>circle_area <span class="ot">&lt;-</span> <span class="fu">area_of_circle</span>(radius)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The area of the circle with radius"</span>, radius, <span class="st">"is"</span>, circle_area, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The area of the circle with radius 5 is 78.53982 </code></pre>
</div>
</div>
<p><img src="images/EpiTriad.png" class="img-fluid"></p>
<p>This image shows the epidemiology triad of environment, host and pathogen. This is a very simplified figure that demonstrates 3 of the major components of infection. Although this image is helpful to summarize ecology, in reality, ecology is much more complex than this image demonstrates.</p>
</section>
<section id="worksheet-2-3" class="level3">
<h3 class="anchored" data-anchor-id="worksheet-2-3">09/12/2024 - Worksheet 2 &amp; 3</h3>
<p><img src="images/ss_table.png" class="img-fluid"></p>
<ol type="1">
<li><p><strong>Find the sample size necessary to detect a disease at or above 5% prevalence in a<br>
herd of 5000 deer. The desired level of confidence is 95%.</strong><br>
The sample size necessary to detect a disease at or above 5% prevalence in a herd of 5000 dear with 95% confidence would be around 60 deer (59 to be exact, according to the table)</p></li>
<li><p><strong>Using the hypergeometric distribution, compare the sample size requirements for the<br>
following scenarios:</strong></p>
<p><br>
<strong>a) 95% confidence in detecting a disease at 1% prevalence in a large population</strong></p>
<p>The sample size for detecting a disease at 1% prevalence with 95% confidence for a large population (say, a population of around 5000) would be around 290-300.<br>
<strong>b) 99% confidence in detecting a disease at 2% prevalence in a large population</strong></p>
<p>The sample size for detecting a disease at 2% prevalence with 99% confidence for a large population (say, a population of around 5000) would be around 225-230.</p>
<p>These sample sizes are pretty similar because although in the second scenario the confidence level went up, the % prevalence we want to detect at also went up. This means that although in theory one might think you need to sample more deer to be more confident, since in the second scenario you only need to detect at 2% instead of 1%, the sample sizes of the 2 scenarios are pretty similar.</p></li>
<li><p><strong>You sample 300 deer from a high fenced facility that has a herd of 4000. None of the<br>
300 have antibodies against Epizootic Hemorrhagic Disease. Based on this finding, you<br>
are 95% confident that the prevalence of exposure to EHD in this facility is _____ (&lt;, =,<br>
&gt;) ____%.</strong></p>
<p>We are 95% confident that the prevalence of exposure to EHD in the facility is &lt; 1%</p>
<p>Because of the rule of 3 for zero sample prevalence -&gt; 3/300 = .01</p></li>
<li><p><strong>An outbreak of ‘Lame disease’ has been reported in wild turkey populations of<br>
Alabama. Turkeys from three counties were sampled for lameness (Lee, Chambers and<br>
Russell counties).</strong></p>
<p><a href="https://raw.githubusercontent.com/anyadoc/audiseco/main/DeerLameness_Lee.csv">Lee County</a></p>
<p><a href="https://raw.githubusercontent.com/anyadoc/audiseco/main/DeerLameness_Chambers.csv">Chambers County</a></p>
<p><a href="https://raw.githubusercontent.com/anyadoc/audiseco/main/DeerLameness_Russell.csv">Russell County</a><br>
<strong>a) Analyze the sample data to determine prevalence of lameness in each county.<br>
Provide confidence interval for prevalence using Sterne’s method.</strong></p>
<p>Lee County: Prevalence of lameness = 20% w/ 95% confidence between (14 - 52.5%)</p>
<p>Chambers County: Prevalence of lameness = 26.7% w/ 95% confidence between (13.1 - 44.9%)</p>
<p>Russell County: Prevalence of lameness = 3.1 % w/ 95% confidence between (0.9 - 8.7%)<br>
<strong>b) Compare prevalences using Fisher’s exact test</strong></p>
<p>Between all 3 counties: p value = .0001 (less than .05 so the data is statistically significant and NOT due to chance)</p></li>
<li><p><strong>Jane was studying the spread of Pink Spot Disease (PSD) in a pond that had 60 fish.<br>
She introduced an infectious fish in the pond on day 0. Her observations are as follows:<br>
Day 1: 3 fish infected<br>
Day 2: 4 fish infected<br>
Day 3: 7 fish infected<br>
Day 4: 11 fish infected<br>
Day 5: 20 fish infected<br>
Note that there is no disease-related mortality. The observations denote all infected fish<br>
in the pond (including previously infected fish).</strong></p>
<p><br>
<strong>a) Find incidence on day 1, day 2 and day 5. Write the unit for incidence.</strong></p>
<p>Day 1 incidence: 3/60 = .05 cases per fish-day</p>
<p>Day 2 Incidence: 1/57 = .018 cases per fish-day</p>
<p>Day 5 Incidence: 9/49 = .184 cases per fish-day<br>
<strong>b) What is the prevalence of PSD on day 3 and day 5?</strong></p>
<p>Day 3 Prevalence: 7/60 = .1167</p>
<p>Day 5 Prevalence: 20/60 = .333<br>
<strong>c) On which day is the prevalence same as the incidence (except the units)?</strong><br>
On day 1 the prevalence and incidence are the same, both 3/60 = .05 (except prevalence has no units and incidents has units in fish-days)</p></li>
</ol>
</section>
<section id="worksheet-4" class="level3">
<h3 class="anchored" data-anchor-id="worksheet-4">10/01/2024 - Worksheet 4</h3>
<p>Effective wildlife management is extremely important when it comes to maintaining biodiversity, protecting ecosystems, and controlling disease outbreaks. In order to control these things, it is essential that we have a deep understanding of wildlife/population systems. More specifically, it’s important to understand complex disease systems and understand contributors to the disease and important parameters. This knowledge helps wildlife managers to effectively do their jobs and in turn protects humans as they attempt to prevent spillover of zoonotic diseases to humans. Modeling plays a vital role in understanding these dynamics. Essentially, modeling allows wildlife managers and other important stakeholders to think critically about a system and make good, educated decisions when it comes to management, disease prevention, and conservation. Starfield explains three essentials of good decision-making in his article, “A Pragmatic Approach to Modeling for Wildlife Management”. He explains that you first must know what the objectives are/what you are trying to achieve. Then you must be able to measure how a particular strategy will perform and be able to assess alternative options. These three pieces of knowledge can be obtained or drawn upon from modeling. For one, disease models allow you to forecast the dynamics of wildlife disease and see how management strategies impact the entire system. For example, Starfield explains a model that demonstrates changes in a buffalo population with and without culling. This is a great example of how models can be actively used to advise decisions. If, hypothetically the model projected that without any culling the buffalo population would grow out of control, that knowledge can allow wildlife managers to create a culling initiative. This idea can be similarly applied to a disease, a model could be drawn up forecasting the burden of disease with capturing and vaccinating a subset of a population, and without. This model could possibly show that capturing and vaccinating a subset of the population is not worth it when it comes to stopping the spread of a disease. This information is vital to public health officials and wildlife managers because we do not want to waste time, money, and resources on initiatives that won’t have long-term benefits. One limitation of disease modeling is the predictive capacity. Disease models cannot predict the future without assumptions, and often times those assumptions are not the reality. For example, in some disease models, we assume that disease is randomly distributed, which in reality is not the case. For this reason, models can forecast future events but not predict without uncertainty. Additionally, often times we do not have complete data when it comes to wildlife diseases. It is unrealistic for us to test/observe every single animal in a population, so there often are data gaps. This is a challenge when it comes to creating a good model; however, that does not mean a model with incomplete data could not be helpful, it just means there is more uncertainty. Another limitation of modeling is ecological complexity. Wildlife populations exist in complex exosystems where there are many interactions, human influences, environmental factors, and confounding variables that are hard to predict. Just as we discussed in class a model cannot accurately account for human behavior changes when risk perception changes, a model cannot completely account for all behaviors of the ecosystem that we may not know about. However, despite these difficulties and limitations, models are still extremely helpful tools that force us to think critically about a system and advise decision-making and problem-solving. Combining models with other tools can be particularly helpful when it comes to management. For example, modeling can be coupled with surveillance programs. Regular monitoring of wildlife for the presence of disease provides real-time data that can then be actively put into a model to give the most up-to-date forecast of the disease. Other tools such as geographic information systems can give spatial analysis to measure disease prevalence and risk areas which then identify specific spatial areas that have a higher prevalence of disease than others. Lastly, modeling can be incorporated into stakeholder engagement to educate stakeholders and the community on wildlife disease or conservation efforts. Models can sometimes make it easier for the public to understand what is going on in complex wildlife systems. Overall, disease models serve as powerful tools in wildlife management, offering critical insights into disease dynamics and informing proactive and effective strategies. While we acknowledge the limitations of models, incorporating modeling with different tools and strategies enhances our ability to effectively manage disease and wildlife as a whole.&nbsp;</p>
</section>
<section id="question-8-from-midterm-re-do" class="level3">
<h3 class="anchored" data-anchor-id="question-8-from-midterm-re-do">10/14/2024 - Question #8 from Midterm Re-Do</h3>
<p>Question 8 Answers</p>
<p>a) Which year has the highest incidence of deer fibroma?</p>
<p>2018</p>
<p>6 new cases/170-6 = 6/164 = .037 cases per deer-year</p>
<p>b) When is the prevalence lowest?</p>
<p>2015</p>
<p>3 total cases/225 = .013</p>
<p>NO UNIT!</p>
</section>
<section id="response-from-in-lab-fecal-egg-counts" class="level3">
<h3 class="anchored" data-anchor-id="response-from-in-lab-fecal-egg-counts">10/23/2024 - Response from in lab Fecal Egg Counts</h3>
<p>Performing fecal egg counts and understanding how the information collected is used was so interesting. For one, I learned that there are many different ways to do fecal egg counts. In this procedure we mixed up the fecal sample with water, strained it, vortexed it, and combined it with a sugar solution. She explained that the sugar solution allows the eggs to float to the top and actually be visible. Additionally, the specific gravity of the sugar solution used depends on what type of eggs in particular you’re looking for. In this lab, she is specifically looking for helmith eggs. The sample was then placed in an egg counting slide with a grid and we waited 5 minutes for the eggs to come to the top. Each egg found on the slide is 50 eggs per g of feces. It was super interesting to hear how this research can have an impact. She explained that they do fecal egg counts before and after the animals are given de wormer to see how effective the de wormer is. However she also explained that same de wormer cannot be given to the animals too much because there are concerns about resistance, something she is researching. It was also interesting that dairy cows do not have as many eggs generally because they are not in the pasture as much. What was also interesting to me was that for some sheep and goats they check their eyes and rank the level of redness on a scale of 1-10. If they are very white this indicates they’re anemic and need de wormer because a parasite is sucking their blood. Overall, this lab was extremely interesting and allowed me to see first hand how we conduct research about disease ecology.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>